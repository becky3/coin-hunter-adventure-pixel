[LOG] Log file created: /mnt/d/claude/pixelAction/coin-hunter-adventure-pixel/tests/e2e/tests/logs/basic-game-flow-2025-07-12_18-54-48-JST.log
[LOG] 
==================================================
[LOG] Starting test: Basic Game Flow
[LOG] Time: 2025-07-12_18-54-48-JST (JST)
[LOG] ==================================================

[LOG] Test timeout set to: 20000ms
[LOG] 💉 Error tracking injected
[LOG] Navigating to: http://localhost:3000/?s=0-1&skip_title=true
[LOG] [Browser Console debug] [vite] connecting...
[LOG] [Browser Console debug] [vite] connected.
[LOG] [Browser Console log] [18:54:51.474] Starting game initialization...
[LOG] [Browser Console log] [18:54:51.475] Initializing GameCore...
[LOG] [Browser Console log] [18:54:51.475] GameCore: init() started
[LOG] [Browser Console log] [18:54:51.475] GameCore: Initializing ResourceLoader...
[LOG] [Browser Console log] [18:54:51.475] [ResourceLoader] Using bundled data for: /src/config/resources/index.json
[LOG] [Browser Console log] [18:54:51.476] [ResourceLoader] Using bundled data for: /src/config/resources/sprites.json
[LOG] [Browser Console log] [18:54:51.476] [ResourceLoader] Using bundled data for: /src/config/resources/characters.json
[LOG] [Browser Console log] [18:54:51.476] [ResourceLoader] Using bundled data for: /src/config/resources/audio.json
[LOG] [Browser Console log] [18:54:51.476] [ResourceLoader] Using bundled data for: /src/config/resources/objects.json
[LOG] [Browser Console log] [18:54:51.476] [ResourceLoader] Using bundled data for: /src/config/resources/bgm/title.json
[LOG] [Browser Console log] [18:54:51.476] [ResourceLoader] Using bundled data for: /src/config/resources/physics.json
[LOG] [Browser Console log] [18:54:51.476] [ResourceLoader] Using bundled data for: /src/config/resources/bgm/game.json
[LOG] [Browser Console log] [18:54:51.476] [ResourceLoader] Using bundled data for: /src/config/resources/bgm/victory.json
[LOG] [Browser Console log] [18:54:51.476] [ResourceLoader] Using bundled data for: /src/config/resources/bgm/gameover.json
[LOG] [Browser Console log] [18:54:51.477] [ResourceLoader] Using bundled data for: /src/config/resources/se/coin.json
[LOG] [Browser Console log] [18:54:51.477] [ResourceLoader] Using bundled data for: /src/config/resources/se/jump.json
[LOG] [Browser Console log] [18:54:51.477] [ResourceLoader] Using bundled data for: /src/config/resources/se/damage.json
[LOG] [Browser Console log] [18:54:51.477] [ResourceLoader] Using bundled data for: /src/config/resources/se/button.json
[LOG] [Browser Console log] [18:54:51.477] [ResourceLoader] Using bundled data for: /src/config/resources/se/gameStart.json
[LOG] [Browser Console log] [18:54:51.477] [ResourceLoader] Using bundled data for: /src/config/resources/se/goal.json
[LOG] [Browser Console log] [18:54:51.477] [ResourceLoader] Using bundled data for: /src/config/resources/se/enemyDefeat.json
[LOG] [Browser Console log] [18:54:51.477] GameCore: Registering core services...
[LOG] [Browser Console log] [18:54:51.478] [PhysicsSystem] Initialized with:
[LOG] [Browser Console log] [18:54:51.478]   - Gravity: 0.65
[LOG] [Browser Console log] [18:54:51.478]   - Max fall speed: 15
[LOG] [Browser Console log] [18:54:51.478]   - Friction: 0.8
[LOG] [Browser Console log] [18:54:51.478] GameCore: Registering systems...
[LOG] [Browser Console log] [18:54:51.478] GameCore: Initializing MusicSystem...
[LOG] [Browser Console log] [18:54:51.479] MusicSystem: init() called
[LOG] [Browser Console log] [18:54:51.543] MusicSystem: AudioContext created
[LOG] [Browser Console log] [18:54:51.543] MusicSystem: AudioContext is suspended, attempting to resume...
[LOG] [Browser Console warn] The AudioContext was not allowed to start. It must be resumed (or created) after a user gesture on the page. https://developer.chrome.com/blog/autoplay/#web_audio
[LOG] ✅ Page loaded
[LOG] Waiting for game initialization...
[LOG] Game object exists: true
[LOG] [Browser Console warn] [18:54:56.544] GameCore: MusicSystem initialization failed, continuing without audio: JSHandle@error
[LOG] [Browser Console log] [18:54:56.544] GameCore: Registering states...
[LOG] [Browser Console log] [18:54:56.545] GameCore: Initializing debug overlay...
[LOG] [Browser Console log] [18:54:56.546] EnemySpawnDialog Initialized
[LOG] [Browser Console log] [18:54:56.546] DebugOverlay Initialized with stage: stage0-1 (index: 3)
[LOG] [Browser Console log] [18:54:56.546] GameCore: Hiding loading screen...
[LOG] [Browser Console log] [18:54:56.547] GameCore: init() completed
[LOG] [Browser Console log] [18:54:56.547] Starting game loop...
[LOG] [Browser Console log] [18:54:56.547] GameCore: Starting game loop...
[LOG] [Browser Console log] [18:54:56.547] GameCore: Game loop started, running: true
[LOG] [Browser Console log] [18:54:56.547] [InitState] Entering initialization state
[LOG] [Browser Console log] [18:54:56.547] GameCore: Initial state set to init
[LOG] [Browser Console log] [18:54:56.547] Game started successfully
[LOG] [Browser Console log] [18:54:56.547] [InitState] Starting initialization...
[LOG] [Browser Console log] [18:54:56.547] [InitState] Input system ready
[LOG] [Browser Console log] [18:54:56.548] [InitState] Physics system ready
[LOG] [Browser Console log] [18:54:56.548] [InitState] Renderer ready
[LOG] [Browser Console log] [18:54:56.548] [InitState] Initialization completed
[LOG] Waiting for init state completion...
[LOG] [Browser Console log] [18:54:56.571] InputSystemAdapter: update called
[LOG] [Browser Console log] [18:54:57.887] [InitState] Skipping title, transitioning to play state with stage: stage0-1
[LOG] [Browser Console log] [18:54:57.888] [InitState] Exiting initialization state
[LOG] [Browser Console log] [18:54:57.888] [PlayState] enter() called with params: JSHandle@object
[LOG] [Browser Console log] [18:54:57.888] [PlayState] Starting initialization...
[LOG] [Browser Console log] [18:54:57.889] [PlayState] Checking/loading sprites...
[LOG] [Browser Console log] [18:54:57.889] [SpriteLoader] Using bundled data for: player/idle
[LOG] [Browser Console log] [18:54:57.890] [SpriteLoader] Using bundled data for: player/walk1
[LOG] [Browser Console log] [18:54:57.890] [SpriteLoader] Using bundled data for: player/jump1
[LOG] [Browser Console log] [18:54:57.890] [SpriteLoader] Using bundled data for: player/idle_small
[LOG] [Browser Console log] [18:54:57.890] [SpriteLoader] Using bundled data for: player/walk_small1
[LOG] [Browser Console log] [18:54:57.890] [SpriteLoader] Using bundled data for: player/jump_small1
[LOG] [Browser Console log] [18:54:57.890] [SpriteLoader] Using bundled data for: terrain/spring
[LOG] [Browser Console log] [18:54:57.890] [SpriteLoader] Using bundled data for: terrain/goal_flag
[LOG] [Browser Console log] [18:54:57.890] [SpriteLoader] Using bundled data for: items/coin_spin1
[LOG] [Browser Console log] [18:54:57.890] [SpriteLoader] Using bundled data for: enemies/slime_idle1
[LOG] [Browser Console log] [18:54:57.891] [SpriteLoader] Using bundled data for: enemies/bird_fly1
[LOG] [Browser Console log] [18:54:57.891] [SpriteLoader] Using bundled data for: environment/cloud1
[LOG] [Browser Console log] [18:54:57.891] [SpriteLoader] Using bundled data for: environment/cloud2
[LOG] [Browser Console log] [18:54:57.891] [SpriteLoader] Using bundled data for: environment/tree1
[LOG] [Browser Console log] [18:54:57.891] [SpriteLoader] Using bundled data for: tiles/ground
[LOG] [Browser Console log] [18:54:57.891] [SpriteLoader] Using bundled data for: tiles/grass_ground
[ERROR] [Browser Console ERROR] Sprite not found: environment/cloud1
[ERROR] [Browser Console ERROR] Sprite not found: environment/cloud2
[ERROR] [Browser Console ERROR] Sprite not found: environment/cloud1
[ERROR] [Browser Console ERROR] Sprite not found: environment/tree1
[ERROR] [Browser Console ERROR] Sprite not found: environment/tree1
[LOG] [Browser Console log] [18:54:57.895] [AssetLoader] Loaded sprite player/idle in 6.40ms
[LOG] [Browser Console log] [18:54:57.896] [SpriteLoader] Using bundled data for: player/walk2
[LOG] [Browser Console log] [18:54:57.896] [SpriteLoader] Using bundled data for: player/jump2
[LOG] [Browser Console log] [18:54:57.896] [AssetLoader] Loaded sprite player/idle_small in 5.90ms
[LOG] [Browser Console log] [18:54:57.896] [SpriteLoader] Using bundled data for: player/walk_small2
[LOG] [Browser Console log] [18:54:57.896] [SpriteLoader] Using bundled data for: player/jump_small2
[LOG] [Browser Console log] [18:54:57.896] [AssetLoader] Loaded sprite terrain/spring in 6.20ms
[LOG] [Browser Console log] [18:54:57.897] [AssetLoader] Loaded sprite terrain/goal_flag in 6.30ms
[LOG] [Browser Console log] [18:54:57.897] [SpriteLoader] Using bundled data for: items/coin_spin2
[LOG] [Browser Console log] [18:54:57.897] [SpriteLoader] Using bundled data for: enemies/slime_idle2
[LOG] [Browser Console log] [18:54:57.897] [SpriteLoader] Using bundled data for: enemies/bird_fly2
[LOG] [Browser Console log] [18:54:57.897] [AssetLoader] Loaded sprite environment/cloud1 in 6.70ms
[LOG] [Browser Console log] [18:54:57.898] [AssetLoader] Loaded sprite environment/cloud2 in 7.00ms
[LOG] [Browser Console log] [18:54:57.898] [AssetLoader] Loaded sprite environment/tree1 in 7.70ms
[LOG] [Browser Console log] [18:54:57.899] [AssetLoader] Loaded sprite tiles/ground in 7.90ms
[LOG] [Browser Console log] [18:54:57.899] [AssetLoader] Loaded sprite tiles/grass_ground in 8.20ms
[LOG] [Browser Console log] [18:54:57.899] [SpriteLoader] Using bundled data for: player/walk3
[LOG] [Browser Console log] [18:54:57.900] [AssetLoader] Loaded animation player/jump (2 frames) in 10.40ms
[LOG] [Browser Console log] [18:54:57.900] [SpriteLoader] Using bundled data for: player/walk_small3
[LOG] [Browser Console log] [18:54:57.901] [AssetLoader] Loaded animation player/jump_small (2 frames) in 10.60ms
[LOG] [Browser Console log] [18:54:57.901] [SpriteLoader] Using bundled data for: items/coin_spin3
[LOG] [Browser Console log] [18:54:57.901] [AssetLoader] Loaded animation enemies/slime_idle (2 frames) in 10.90ms
[LOG] [Browser Console log] [18:54:57.902] [AssetLoader] Loaded animation enemies/bird_fly (2 frames) in 11.20ms
[LOG] [Browser Console log] [18:54:57.902] [SpriteLoader] Using bundled data for: player/walk4
[LOG] [Browser Console log] [18:54:57.902] [SpriteLoader] Using bundled data for: player/walk_small4
[LOG] [Browser Console log] [18:54:57.902] [SpriteLoader] Using bundled data for: items/coin_spin4
[LOG] [Browser Console log] [18:54:57.903] [AssetLoader] Loaded animation player/walk (4 frames) in 13.00ms
[LOG] [Browser Console log] [18:54:57.903] [AssetLoader] Loaded animation player/walk_small (4 frames) in 13.30ms
[LOG] [Browser Console log] [18:54:57.904] [AssetLoader] Loaded animation items/coin_spin (4 frames) in 13.40ms
[LOG] [Browser Console log] [18:54:57.904] [PlayState] Sprites loaded successfully in 15.10ms
[LOG] [Browser Console log] [18:54:57.904] [AssetLoader] Stage type set to: grassland
[LOG] [Browser Console log] [18:54:57.904] [LevelLoader] Using bundled data for: /src/levels/data/stages.json
[LOG] [Browser Console log] [18:54:57.905] [LevelLoader] Using bundled data for: /src/levels/data/stage0-1.json
[LOG] [Browser Console warn] [18:54:57.905] [GameController] 警告: プレイヤーのスポーン位置(2, 10)の下に地面がありません
[LOG] [Browser Console log] [18:54:57.905] [EntityManager] Creating player at (32, 160)
[LOG] [Browser Console log] [18:54:57.906] [Player] Jump Configuration Debug:
[LOG] [Browser Console log] [18:54:57.906]   - Config source: physics.json
[LOG] [Browser Console log] [18:54:57.906]   - jumpPower: 10
[LOG] [Browser Console log] [18:54:57.906]   - variableJumpBoost: 
[LOG] [Browser Console log] [18:54:57.906]   - variableJumpBoostMultiplier: 
[LOG] [Browser Console log] [18:54:57.906]   - minJumpTime: 0
[LOG] [Browser Console log] [18:54:57.906]   - maxJumpTime: 400
[LOG] [Browser Console log] [18:54:57.906]   - airResistance: 0
[LOG] [Browser Console log] [18:54:57.906]   - gravityScale: 1
[LOG] [Browser Console log] [18:54:57.906]   - maxFallSpeed: 10
[LOG] [Browser Console log] [18:54:57.907] [EntityManager] Player created: success
[LOG] [Browser Console log] [18:54:57.907] Enemy Created at x=96, y=192
[LOG] [Browser Console log] [18:54:57.907] [EntityManager] Creating slime at (96, 192)
[LOG] [Browser Console log] [18:54:57.907] [EntityManager] Physics system has tilemap: true
[LOG] [Browser Console log] [18:54:57.908] Enemy Created at x=224, y=192
[LOG] [Browser Console log] [18:54:57.908] [EntityManager] Creating slime at (224, 192)
[LOG] [Browser Console log] [18:54:57.908] [EntityManager] Physics system has tilemap: true
[LOG] [Browser Console log] [18:54:57.908] [PlayState] levelData: JSHandle@object
[LOG] [Browser Console log] [18:54:57.908] [PlayState] levelData.name: STAGE 0-1
[LOG] [Browser Console log] [18:54:57.908] [PlayState] Stage name set to: STAGE 0-1
[LOG] [Browser Console log] [18:54:57.908] [PlayState] MusicSystem status: JSHandle@object
[LOG] [Browser Console log] [18:54:57.908] [PlayState] Player created successfully
[LOG] [Browser Console log] [18:54:57.909] [PlayState] enter() completed in 20.40ms
[LOG] ✅ init state completion met
[LOG] ✅ Game initialized
[LOG] [Browser Console log] PlayState ready event received: JSHandle@object
[LOG] [Browser Console log] [18:54:57.915] [PlayState] Ready event dispatched on first update
[LOG] ✅ Assert: Current state is 'play'
[LOG] Waiting for PlayState ready...
[LOG] Waiting for PlayState ready...
[LOG] ✅ PlayState ready met
[LOG] ✅ PlayState is ready
[LOG] ✅ Assert: Player exists
[LOG] Initial player stats: [object Object]
[LOG] 
--- Testing Player Movement ---
[LOG] Start position: (32.00, 132.97)
[LOG] Debug display - Initial X: 32, Y: 132
[LOG] Moving player right for 1000ms
[LOG] Holding key: ArrowRight for 1000ms
[LOG] [Browser Console warn] [18:54:58.504] [MusicSystem] Cannot play SE 'damage' - system not initialized
[LOG] [Browser Console log] [18:54:59.037] [PlayState] Player fell! Instant death.
[LOG] [Browser Console log] [18:54:59.038] [PlayState] handlePlayerDeath: lives after decrement: 2
[LOG] [Browser Console log] [18:54:59.038] [PlayState] Respawning player at: 2, 10
[LOG] [Browser Console log] [18:54:59.038] [Player] respawn called at (32, 160)
[LOG] [Browser Console log] [18:54:59.038] [Player] Dispatching window player:respawned event
[LOG] After moving right: (32.00, 176.00)
[ERROR] 
❌ TEST FAILED

[ERROR] Error: Player did not move right
[LOG] 📸 Screenshot saved: Basic Game Flow-test-failure-2025-07-12_18-54-59-JST.png
[LOG] 
==================================================
