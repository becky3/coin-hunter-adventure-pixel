# Gemini CLI エージェントガイド

## 概要

このドキュメントは、Gemini CLI エージェントとの効果的な連携のためのガイドラインを提供します。
Geminiは、ソフトウェアエンジニアリングタスク（バグ修正、機能追加、リファクタリング、コード説明、テスト、レビューなど）を支援するために設計されています。

## Geminiとの連携方法

### 1. 明確な指示

*   **具体的かつ簡潔に:** 実行してほしいタスクを明確に記述してください。曖昧な指示は、意図しない結果を招く可能性があります。
*   **コンテキストの提供:** 必要に応じて、関連するファイルパス、コードスニペット、期待される出力など、タスクを理解するために必要なコンテキストを提供してください。

### 2. ツールと対話

Geminiは、ファイルシステム操作、シェルコマンド実行、Web検索などのツールを使用します。

*   **ツールの実行承認:** Geminiがツールを実行しようとする際、承認を求められることがあります。内容を確認し、安全であることを確認した上で承認してください。
*   **シェルコマンドの注意:** ファイルシステムを変更する可能性のあるシェルコマンド（例: `rm`, `mv`, `git commit`）については、Geminiがその目的と影響を説明します。内容をよく理解した上で承認してください。

### 3. フィードバックとレビュー

*   **Pull Requestのレビュー:** GeminiはPull Requestのレビューとテストを支援できます。詳細なプロセスは `handover-docs/gemini-to-claude/2025-06-28_gemini-review-process.md` を参照してください。
*   **コメントのユニークID:** Geminiは、Pull Requestへのコメントに `ID: GEMINI-REVIEW-YYYYMMDD-XX` のようなユニークなIDを付与します。これにより、特定のフィードバックを追跡しやすくなります。

### 4. エラーと問題

*   **エラー発生時:** Geminiがタスクを完了できない場合やエラーが発生した場合、その理由を説明します。必要に応じて、追加情報を提供したり、代替案を検討したりしてください。
*   **対話の中断:** Geminiとの対話が中断された場合（例: ネットワーク接続の問題、ツールの実行キャンセル）、再度指示を出すことで作業を再開できます。

### 5. Pull Requestへのコメント

*   **Markdown形式の維持:** Pull Requestへのコメントは、Markdown形式で記述し、改行や書式が正しく反映されるようにします。
    *   **推奨される方法:** コメント内容を一時ファイル（例: `comment.md`）に書き込み、`cat comment.md | gh pr comment <PR番号> --body-file -` のようにパイプで渡すことで、シェルによる解釈の影響を最小限に抑え、Markdown形式を確実に反映させることができます。
    *   **代替方法:** `gh pr comment <PR番号> --body-file <ファイルパス>` も利用可能ですが、環境によってはシェルによる解釈の問題が発生する場合があります。
    *   **直接入力の回避:** `gh pr comment <PR番号> --body "コメント内容"` のように直接文字列を渡す方法は、特殊文字や改行の扱いで問題が発生しやすいため、避けるべきです。

## 重要な考慮事項

*   **プロジェクトの慣習:** Geminiは、既存のプロジェクトのコーディング規約、ファイル構造、テスト方法などを尊重し、それに従うように努めます。
*   **安全性:** Geminiは、ユーザーのシステムやコードベースに不必要なリスクをもたらさないよう、安全性を最優先します。
*   **継続的な学習:** Geminiは、ユーザーとの対話を通じて学習し、より効果的な支援を提供できるよう改善を続けます。
*   **ブランチ運用:** 新しい機能や修正に取り組む際、既存のPull Requestに関連する作業でない限り、新しいブランチを作成します。既存のPull Requestに関連する作業の場合は、そのPull Requestのブランチで作業を継続します。
*   **改善提案:** Claude Code やユーザーとのやり取り、Gemini自身の作業プロセスにおいて、改善点や効率化のアイデアがあれば積極的に提案します。提案はPull Requestのコメントや、必要に応じて別途ドキュメントとして作成します。
*   **引き継ぎ資料:** Geminiが作成する引き継ぎ資料は `handover-docs/gemini-to-claude/` ディレクトリに格納されます。過去の作業内容やレビュー結果、テスト手順などを確認する際に参照してください。
*   **テストの実行:**
    *   基本的なテストは `npm run test:simple` で実行できます。
    *   ゲームプレイテストは `node tests/puppeteer/test-gameplay.js` で実行できます。
    *   パフォーマンステストは `node tests/puppeteer/test-performance.js` で実行できます。

## 困ったときは

*   `/help` コマンドで利用可能なコマンドと一般的なガイドラインを表示できます。
*   `/bug` コマンドでバグを報告したり、フィードバックを提供したりできます。