# coin-hunter-adventure-pixel 開発ルール

このドキュメントは、プロジェクトの進め方、作業フロー、Git運用などの開発プロセスに関するルールを定めています。

## 1. プロジェクト構成

### リポジトリ管理
- **メインリポジトリ**: `/coin-hunter-adventure-pixel/` - 新規開発用
- **参照用アーカイブ**: `/old_project_achive/testAction/` - 読み取り専用（参照のみ）

### 関連ドキュメント
- **コーディング規約**: `CODING_STANDARDS.md` - コードの書き方、命名規則
- **アーキテクチャ**: `ARCHITECTURE.md` - ディレクトリ構造、設計方針
- **引き継ぎ資料**: `handover-docs/` フォルダ内 - 作業の引き継ぎ資料

### 日付の記載ルール
- **フォーマット**: `YYYY-MM-DD` 形式（例: 2025-06-24）
- **タイムゾーン**: JST（日本標準時）
- **ファイル名**: 引き継ぎ資料は `handover-docs/YYYY-MM-DD_作業内容.md` 形式で保存

## 2. Git運用ルール

### ブランチ戦略
```
main                    # 本番環境
├── develop            # 開発統合ブランチ  
│   ├── feature/xxx    # 機能開発
│   └── bugfix/xxx     # バグ修正
└── release/v1.0       # リリース準備
```

### ブランチ作成のルール
**重要**: mainブランチへの直接プッシュは禁止です。

1. **必ずfeatureブランチを作成してから作業を開始**
   ```bash
   git checkout -b feature/機能名
   ```

2. **作業の流れ**
   - featureブランチで開発・コミット
   - プッシュしてPull Requestを作成
   - レビューを受ける
   - 承認後にマージ

3. **ブランチ名の規則**
   - `feature/` - 新機能開発
   - `bugfix/` - バグ修正
   - `hotfix/` - 緊急修正
   - 小文字、ハイフン区切りを使用

### コミットメッセージ規約
```
<type>: <subject>

[optional body]
```

**Type一覧:**
- `feat`: 新機能追加
- `fix`: バグ修正
- `docs`: ドキュメントのみの変更
- `style`: コードの意味に影響しない変更（空白、フォーマット等）
- `refactor`: バグ修正や機能追加を伴わないコード変更
- `test`: テストの追加・修正
- `chore`: ビルドプロセスやツールの変更

## 3. 開発フロー

### 作業開始前
1. mainブランチを最新に更新
   ```bash
   git checkout main
   git pull origin main
   ```
2. GitHub Issueを確認し、作業内容と優先度を把握
   ```bash
   gh issue list
   ```
3. 関連ドキュメントを確認（CLAUDE.md、各種仕様書）
4. TodoListで作業計画を作成・管理
5. 必要なドキュメントを参照

### 作業中の確認事項
- **疑問がある場合は立ち止まる**: ドキュメントの内容に矛盾や不明確な点があれば、実装前に確認
- **引き継ぎ内容の検証**: 引き継がれた情報が現在のプロジェクトに適合するか確認
- **コンテキストの確認**: 旧プロジェクトのルールを新プロジェクトに適用する前に妥当性を確認

### 実装時の原則
1. **既存コードの活用**
   - `/old_project_achive/testAction/` のロジックを参考に
   - 描画部分のみCanvas対応に変更
   
2. **段階的な実装**
   - 小さな単位で実装・動作確認
   - 各フェーズごとにテストを実施

3. **品質チェック**
   - 定期的に `npm run lint` を実行
   - テストが存在する場合は `npm test` を実行

### 作業完了時
1. lintエラーがないことを確認
2. 基本動作確認を実施
3. TodoListを更新
4. GitHub Copilotレビューの指摘を確認・対応

## 4. ファイル管理の原則

### ファイル作成・編集のルール
- **最小限の原則**: 必要最小限のファイルのみ作成
- **既存優先**: 既存ファイルの編集を優先

### 禁止事項
- 不要なコメントの追加
- セキュリティを損なうコードの実装
- 秘密情報のハードコーディング
- 絵文字の使用（明示的な要求時を除く）

## 5. SVG→Canvas移植の方針

### 変換ガイドライン
| SVGベース | Canvasベース |
|-----------|--------------|
| SVG要素操作 | Canvas API描画 |
| CSSアニメーション | JavaScriptアニメーション |
| DOMイベント | Canvas座標計算 |

### 再利用可能な要素
- ゲームロジック（物理演算、衝突判定）
- ゲーム状態管理
- レベルデータ構造
- 音声管理システム

## 6. 開発環境

### 必要なツール
- Node.js 16+
- npm
- Git
- テキストエディタ（VSCode推奨）

### 開発サーバー
```bash
npm run dev    # Vite開発サーバー起動
```

## 7. コードレビューとフィードバック

### GitHub Copilotレビューへの対応
- PRに対するCopilotの自動レビュー指摘事項を確認
- 妥当な指摘については修正を実施
- セキュリティ、パフォーマンス、コード品質の改善提案を積極的に採用
- 指摘が不適切な場合は、理由を明確にしてスキップ可能

### Copilotコメントの確認方法
Copilotのレビューコメントは複数の場所に表示される可能性があります：

1. **通常のPRコメント確認**
   ```bash
   gh pr view --comments
   ```

2. **レビューコメントの確認（スレッド形式）**
   ```bash
   gh api repos/becky3/coin-hunter-adventure-pixel/pulls/[PR番号]/comments
   ```

3. **レビュー情報の確認**
   ```bash
   gh pr view [PR番号] --json reviews --jq '.reviews[]'
   ```

4. **Web UI での確認**
   - PR画面の「Files changed」タブでインラインコメントを確認
   - 「Conversation」タブで全体のコメントを確認
   - 低信頼度で非表示になっているコメントも「Show resolved」で確認

### レビュー対応の優先順位
1. **高優先度**: セキュリティ問題、バグ、メモリリーク
2. **中優先度**: パフォーマンス最適化、コード品質
3. **低優先度**: コードスタイル、命名規則

## 8. テスト・デバッグ

### 基本的な確認項目
- [ ] 60FPSでの安定動作
- [ ] 基本的な入力応答
- [ ] メモリリークがないこと
- [ ] エラーが発生しないこと

### デバッグ方法
- ブラウザの開発者ツールを活用
- `console.log` は開発中のみ使用可
- パフォーマンスプロファイラーで最適化

## 9. 参考資料

### プロジェクトドキュメント
- ゲーム仕様: `docs/GAME_SPECIFICATION.md`
- 技術仕様: `docs/TECHNICAL_SPECIFICATION.md`
- 実装ロードマップ: `docs/IMPLEMENTATION_ROADMAP.md`

### 元プロジェクト
- 参照先: `/old_project_achive/testAction/`
- 特に `src/` ディレクトリのゲームロジックを参考に